@model InventoryManagementApp.ViewModels.InventoryViewModels.AddItemViewModel

<h3>Items</h3>

<!-- 🔹 Кнопка для показа/скрытия формы -->
<button id="showAddItemForm" class="btn btn-success mb-3">Add Item</button>

<!-- 🔹 Контейнер с формой для добавления айтема -->
<div id="addItemFormContainer" style="display:none;">
    @await Html.PartialAsync("_AddItemFormPartial", Model)
</div>

<!-- 🔹 Контейнер для списка айтемов -->
<div id="itemListContainer">
    @await Html.PartialAsync("_ItemListPartial", Model.Items)
</div>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var addButton = document.getElementById("showAddItemForm");
            var formContainer = document.getElementById("addItemFormContainer");

            // Показываем/скрываем форму
            addButton.addEventListener("click", function(e) {
                e.preventDefault();
                formContainer.style.display = (formContainer.style.display === "none") ? "block" : "none";
            });

            // AJAX отправка формы
            var addItemForm = document.getElementById("addItemForm");
            addItemForm.addEventListener("submit", function(e) {
                e.preventDefault();

                var formData = new FormData(addItemForm);

                fetch(addItemForm.action, {
                    method: addItemForm.method,
                    body: formData,
                    headers: { 'X-Requested-With': 'XMLHttpRequest' }
                })
                .then(response => response.text())
                .then(html => {
                    // Обновляем список айтемов
                    document.getElementById("itemListContainer").innerHTML = html;

                    // Сбрасываем форму и прячем
                    addItemForm.reset();
                    formContainer.style.display = "none";
                })
                .catch(err => console.error(err));
            });
        });
    </script>
}
