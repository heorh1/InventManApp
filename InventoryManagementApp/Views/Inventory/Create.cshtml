@model InventoryManagementApp.ViewModels.InventoryViewModels.InventoryCreateViewModel

@{
    ViewData["Title"] = "Create Inventory";
}

<h2>Create Inventory</h2>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success">@TempData["SuccessMessage"]</div>
}
@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger">@TempData["ErrorMessage"]</div>
}

<form asp-action="Create" method="post">
    @Html.AntiForgeryToken()

    <div class="tab-container">
        <ul class="nav nav-tabs" id="inventoryTabs" role="tablist">
            <li class="nav-item"><button class="nav-link active" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab">Settings</button></li>
            <li class="nav-item"><button class="nav-link" id="customid-tab" data-bs-toggle="tab" data-bs-target="#customid" type="button" role="tab">Custom ID</button></li>
            <li class="nav-item"><button class="nav-link" id="fields-tab" data-bs-toggle="tab" data-bs-target="#fields" type="button" role="tab">Fields</button></li>
            <li class="nav-item"><button class="nav-link" id="access-tab" data-bs-toggle="tab" data-bs-target="#access" type="button" role="tab">Access</button></li>
            <li class="nav-item"><button class="nav-link" id="items-tab" data-bs-toggle="tab" data-bs-target="#items" type="button" role="tab">Items</button></li>
        </ul>

        <div class="tab-content p-3 border border-top-0" id="inventoryTabsContent">
            @await Html.PartialAsync("CreateTabs/_Settings", Model)
            @await Html.PartialAsync("CreateTabs/_CustomId", Model)
            @await Html.PartialAsync("CreateTabs/_Fields", Model)
            @await Html.PartialAsync("CreateTabs/_Access", Model)
        </div>

        <button type="submit" class="btn btn-primary mt-3">Save Inventory</button>
    </div>
</form>

<div class="tab-pane fade @((ViewBag.ActiveTab == "items") ? "show active" : "")" id="items" role="tabpanel">
    @await Html.PartialAsync("CreateTabs/_Items", new InventoryManagementApp.ViewModels.InventoryViewModels.AddItemViewModel
    {
        InventoryId = Model.InventoryId ?? 0,
        CustomString1Name = Model.CustomString1Name,
        CustomString2Name = Model.CustomString2Name,
        CustomString3Name = Model.CustomString3Name,
        CustomInt1Name = Model.CustomInt1Name,
        CustomInt2Name = Model.CustomInt2Name,
        CustomInt3Name = Model.CustomInt3Name,
        CustomBool1Name = Model.CustomBool1Name,
        CustomBool2Name = Model.CustomBool2Name,
        CustomBool3Name = Model.CustomBool3Name,
        CustomMultiline1Name = Model.CustomMultiline1Name,
        CustomMultiline2Name = Model.CustomMultiline2Name,
        CustomMultiline3Name = Model.CustomMultiline3Name,
        CustomLink1Name = Model.CustomLink1Name,
        CustomLink2Name = Model.CustomLink2Name,
        CustomLink3Name = Model.CustomLink3Name
        })
</div>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var activeTab = '@ViewBag.ActiveTab';
            if (activeTab) {
                var tab = new bootstrap.Tab(document.querySelector(`#${activeTab}-tab`));
                tab.show();
            }
        });
    </script>
}
